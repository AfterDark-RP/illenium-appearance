(()=>{var b=e=>new Promise(a=>setTimeout(a,e)),C=e=>{let a=GetEntityModel(e),t=GetHashKey("mp_m_freemode_01"),o=GetHashKey("mp_f_freemode_01");return a===t||a===o},f=e=>{let a=GetEntityModel(e),t=GetHashKey("mp_m_freemode_01");return a===t};function g(e){return{x:e[0],y:e[1],z:e[2]}}var le=()=>{let e=PlayerPedId(),a=GetEntityHealth(e),t=GetPedArmour(e);return[a,t]},se=(e,a)=>{let t=PlayerPedId();SetEntityHealth(t,e),SetPedArmour(t,a)};var O=[0,1,2,3,4,5,6,7,8,9,10,11],D=[0,1,2,6,7],F=["noseWidth","nosePeakHigh","nosePeakSize","noseBoneHigh","nosePeakLowering","noseBoneTwist","eyeBrownHigh","eyeBrownForward","cheeksBoneHigh","cheeksBoneWidth","cheeksWidth","eyesOpening","lipsThickness","jawBoneWidth","jawBoneBackSize","chinBoneLowering","chinBoneLenght","chinBoneSize","chinHole","neckThickness"],S=["blemishes","beard","eyebrows","ageing","makeUp","blush","complexion","sunDamage","lipstick","moleAndFreckles","chestHair","bodyBlemishes"],ce=["Green","Emerald","Light Blue","Ocean Blue","Light Brown","Dark Brown","Hazel","Dark Gray","Light Gray","Pink","Yellow","Purple","Blackout","Shades of Gray","Tequila Sunrise","Atomic","Warp","ECola","Space Ranger","Ying Yang","Bullseye","Lizard","Dragon","Extra Terrestrial","Goat","Smiley","Possessed","Demon","Infected","Alien","Undead","Zombie"];var de={ped:!0,headBlend:!0,faceFeatures:!0,headOverlays:!0,components:!0,props:!0,tattoos:!0},j={head:{animations:{on:{dict:"mp_masks@standard_car@ds@",anim:"put_on_mask",move:51,duration:600},off:{dict:"missheist_agency2ahelmet",anim:"take_off_helmet_stand",move:51,duration:1200}},props:{male:[[1,0]],female:[[1,0]]}},body:{animations:{on:{dict:"clothingtie",anim:"try_tie_negative_a",move:51,duration:1200},off:{dict:"clothingtie",anim:"try_tie_negative_a",move:51,duration:1200}},props:{male:[[11,252],[3,15],[8,15],[10,0],[5,0]],female:[[11,15],[8,14],[3,15],[10,0],[5,0]]}},bottom:{animations:{on:{dict:"re@construction",anim:"out_of_breath",move:51,duration:1300},off:{dict:"re@construction",anim:"out_of_breath",move:51,duration:1300}},props:{male:[[4,61],[6,34]],female:[[4,15],[6,35]]}}};function _e(){RegisterNuiCallbackType("appearance_get_locales"),RegisterNuiCallbackType("appearance_get_settings_and_data"),RegisterNuiCallbackType("appearance_set_camera"),RegisterNuiCallbackType("appearance_turn_around"),RegisterNuiCallbackType("appearance_rotate_camera"),RegisterNuiCallbackType("appearance_change_model"),RegisterNuiCallbackType("appearance_change_head_blend"),RegisterNuiCallbackType("appearance_change_face_feature"),RegisterNuiCallbackType("appearance_change_hair"),RegisterNuiCallbackType("appearance_change_head_overlay"),RegisterNuiCallbackType("appearance_change_eye_color"),RegisterNuiCallbackType("appearance_change_component"),RegisterNuiCallbackType("appearance_change_prop"),RegisterNuiCallbackType("appearance_apply_tattoo"),RegisterNuiCallbackType("appearance_preview_tattoo"),RegisterNuiCallbackType("appearance_delete_tattoo"),RegisterNuiCallbackType("appearance_wear_clothes"),RegisterNuiCallbackType("appearance_remove_clothes"),RegisterNuiCallbackType("appearance_save"),RegisterNuiCallbackType("appearance_exit"),RegisterNuiCallbackType("rotate_left"),RegisterNuiCallbackType("rotate_right"),on("__cfx_nui:appearance_get_locales",(e,a)=>{let t=LoadResourceFile(GetCurrentResourceName(),`locales/${GetConvar("fivem-appearance:locale","en")}.json`);a(t)}),on("__cfx_nui:appearance_get_settings_and_data",(e,a)=>{let t=ue(),o=$(),r=Y();a({config:t,appearanceData:o,appearanceSettings:r})}),on("__cfx_nui:appearance_set_camera",(e,a)=>{a({}),ee(e)}),on("__cfx_nui:appearance_turn_around",(e,a)=>{a({}),B(PlayerPedId(),180)}),on("__cfx_nui:appearance_rotate_camera",(e,a)=>{a({}),pe(e)}),on("__cfx_nui:appearance_change_model",async(e,a)=>{await L(e);let t=PlayerPedId();SetEntityHeading(PlayerPedId(),Z),SetEntityInvincible(t,!0),TaskStandStill(t,-1);let o=H(t),r=Y();a({appearanceSettings:r,appearanceData:o})}),on("__cfx_nui:appearance_change_component",(e,a)=>{let t=PlayerPedId();z(t,e),a(Q(t,e.component_id))}),on("__cfx_nui:appearance_change_prop",(e,a)=>{let t=PlayerPedId();V(t,e),a(X(t,e.prop_id))}),on("__cfx_nui:appearance_change_head_blend",(e,a)=>{a({}),M(PlayerPedId(),e)}),on("__cfx_nui:appearance_change_face_feature",(e,a)=>{a({}),k(PlayerPedId(),e)}),on("__cfx_nui:appearance_change_head_overlay",(e,a)=>{a({}),G(PlayerPedId(),e)}),on("__cfx_nui:appearance_change_hair",(e,a)=>{let t=PlayerPedId();N(t,e),a(ye(t,e))}),on("__cfx_nui:appearance_change_eye_color",(e,a)=>{a({}),T(PlayerPedId(),e)}),on("__cfx_nui:appearance_apply_tattoo",(e,a)=>{a({}),ve(PlayerPedId(),e)}),on("__cfx_nui:appearance_preview_tattoo",(e,a)=>{a({});let{data:t,tattoo:o}=e;ge(PlayerPedId(),t,o)}),on("__cfx_nui:appearance_delete_tattoo",(e,a)=>{a({}),fe(PlayerPedId(),e)}),on("__cfx_nui:appearance_wear_clothes",(e,a)=>{a({});let{data:t,key:o}=e;me(t,o)}),on("__cfx_nui:appearance_remove_clothes",(e,a)=>{a({}),Pe(e)}),on("__cfx_nui:appearance_save",(e,a)=>{a({}),J(e)}),on("__cfx_nui:appearance_exit",(e,a)=>{a({}),J()}),on("__cfx_nui:rotate_left",(e,a)=>{a({}),B(PlayerPedId(),10)}),on("__cfx_nui:rotate_right",(e,a)=>{a({}),B(PlayerPedId(),-10)})}var Ie=global.exports,he={default:{coords:{x:0,y:2.2,z:.2},point:{x:0,y:0,z:-.05}},head:{coords:{x:0,y:.9,z:.65},point:{x:0,y:0,z:.6}},body:{coords:{x:0,y:1.2,z:.2},point:{x:0,y:0,z:.2}},bottom:{coords:{x:0,y:.98,z:-.7},point:{x:0,y:0,z:-.9}}},we={default:{x:1.5,y:-1},head:{x:.7,y:-.45},body:{x:1.2,y:-.45},bottom:{x:.7,y:-.45}},U,ae,A,I,Z,m,w,x,h,Ce={};function He(){let e={hair:[],makeUp:[]};for(let a=0;a<GetNumHairColors();a++)e.hair.push(GetPedHairRgbColor(a));for(let a=0;a<GetNumMakeupColors();a++)e.makeUp.push(GetMakeupRgbColor(a));return e}function $(){return A||(A=H(PlayerPedId())),A}function xe(e,a){for(var t={drawables:[],textures:[]},o=0;o<e.length;o++){if(e[o].drawable===a&&e[o].textures!==void 0)for(var r=0;r<e[o].textures.length;r++)t.textures.push(e[o].textures[r]);(e[o].textures===void 0||e[o].textures.length==0)&&t.drawables.push(e[o].drawable)}return t}function Ee(e,a){let t=E.male.components;switch(e||(t=E.female.components),a){case 1:return t.masks;case 3:return t.upperBody;case 4:return t.lowerBody;case 5:return t.bags;case 6:return t.shoes;case 7:return t.scarfAndChains;case 8:return t.shirts;case 9:return t.bodyArmor;case 10:return t.decals;case 11:return t.jackets;default:break}return[]}function Re(e,a){let t=E.male.props;switch(e||(t=E.female.props),a){case 0:return t.hats;case 1:return t.glasses;case 2:return t.ear;case 6:return t.watches;case 7:return t.bracelets;default:break}return[]}function Q(e,a){let t=GetPedDrawableVariation(e,a),o=f(e);var r={drawables:[],textures:[]};return C(e)&&(r=xe(Ee(o,a),t)),{component_id:a,drawable:{min:0,max:GetNumberOfPedDrawableVariations(e,a)-1},texture:{min:0,max:GetNumberOfPedTextureVariations(e,a,t)-1},blacklist:r}}function X(e,a){let t=GetPedPropIndex(e,a),o=f(e);var r={drawables:[],textures:[]};return C(e)&&(r=xe(Re(o,a),t)),{prop_id:a,drawable:{min:-1,max:GetNumberOfPedPropDrawableVariations(e,a)-1},texture:{min:-1,max:GetNumberOfPedPropTextureVariations(e,a,t)-1},blacklist:r}}function ye(e,a){let t=He();return{style:{min:0,max:GetNumberOfPedDrawableVariations(e,2)-1},color:{items:t.hair},highlight:{items:t.hair},texture:{min:0,max:GetNumberOfPedTextureVariations(e,2,a.style)-1}}}function Y(){let e=PlayerPedId(),a={model:{items:oe}},t={items:Fe},o=O.map(y=>Q(e,y)),r=D.map(y=>X(e,y)),n={shapeFirst:{min:0,max:45},shapeSecond:{min:0,max:45},skinFirst:{min:0,max:45},skinSecond:{min:0,max:45},shapeMix:{min:0,max:1,factor:.1},skinMix:{min:0,max:1,factor:.1}},l=F.reduce((y,u)=>({...y,[u]:{min:-1,max:1,factor:.1}}),{}),i=He(),s={beard:i.hair,eyebrows:i.hair,chestHair:i.hair,makeUp:i.makeUp,blush:i.makeUp,lipstick:i.makeUp},c=S.reduce((y,u,v)=>{let P={style:{min:0,max:GetPedHeadOverlayNum(v)-1},opacity:{min:0,max:1,factor:.1}};return s[u]&&Object.assign(P,{color:{items:s[u]}}),{...y,[u]:P}},{}),d={style:{min:0,max:GetNumberOfPedDrawableVariations(e,2)-1},color:{items:i.hair},highlight:{items:i.hair},texture:{min:0,max:GetNumberOfPedTextureVariations(e,2,GetPedDrawableVariation(e,2))-1}};return{ped:a,components:o,props:r,headBlend:n,faceFeatures:l,headOverlays:c,hair:d,eyeColor:{min:0,max:30},tattoos:t}}function ue(){return ae}function ee(e){if(h)return;e!=="current"&&(w=e);let{coords:a,point:t}=he[w],o=x?-1:1;if(m){let r=g(GetOffsetFromEntityInWorldCoords(PlayerPedId(),a.x*o,a.y*o,a.z)),n=g(GetOffsetFromEntityInWorldCoords(PlayerPedId(),t.x,t.y,t.z)),l=CreateCameraWithParams("DEFAULT_SCRIPTED_CAMERA",r.x,r.y,r.z,0,0,0,50,!1,0);PointCamAtCoord(l,n.x,n.y,n.z),SetCamActiveWithInterp(l,m,1e3,1,1),h=!0;let i=setInterval(()=>{!IsCamInterpolating(m)&&IsCamActive(l)&&(DestroyCam(m,!1),m=l,h=!1,clearInterval(i))},500)}else{let r=g(GetOffsetFromEntityInWorldCoords(PlayerPedId(),a.x,a.y,a.z)),n=g(GetOffsetFromEntityInWorldCoords(PlayerPedId(),t.x,t.y,t.z));m=CreateCameraWithParams("DEFAULT_SCRIPTED_CAMERA",r.x,r.y,r.z,0,0,0,50,!1,0),PointCamAtCoord(m,n.x,n.y,n.z),SetCamActive(m,!0)}}async function pe(e){if(h)return;let{coords:a,point:t}=he[w],o=we[w],r,n=x?-1:1;e==="left"?r=1:e==="right"&&(r=-1);let l=g(GetOffsetFromEntityInWorldCoords(PlayerPedId(),(a.x+o.x)*r*n,(a.y+o.y)*n,a.z)),i=g(GetOffsetFromEntityInWorldCoords(PlayerPedId(),t.x,t.y,t.z)),s=CreateCameraWithParams("DEFAULT_SCRIPTED_CAMERA",l.x,l.y,l.z,0,0,0,50,!1,0);PointCamAtCoord(s,i.x,i.y,i.z),SetCamActiveWithInterp(s,m,1e3,1,1),h=!0;let c=setInterval(()=>{!IsCamInterpolating(m)&&IsCamActive(s)&&(DestroyCam(m,!1),m=s,h=!1,clearInterval(c))},500)}function B(e,a){x=!x;let t=OpenSequenceTask()??0;t!==0&&(TaskGoStraightToCoord(0,I.x,I.y,I.z,8,-1,GetEntityHeading(e)-a,.1),TaskStandStill(0,-1),CloseSequenceTask(t),ClearPedTasks(e),TaskPerformSequence(e,t),ClearSequenceTask(t))}async function me(e,a){let{animations:t,props:o}=j[a],{dict:r,anim:n,move:l,duration:i}=t.on,{male:s,female:c}=o,{components:d}=e,p=PlayerPedId(),y=f(p);for(RequestAnimDict(r);!HasAnimDictLoaded(r);)await b(0);if(y)for(let u=0;u<s.length;u++){let[v]=s[u];for(let P=0;P<d.length;P++){let{component_id:W,drawable:K,texture:q}=d[P];W===v&&SetPedComponentVariation(p,v,K,q,2)}}else for(let u=0;u<c.length;u++){let[v]=c[u];for(let P=0;P<d.length;P++){let{component_id:W,drawable:K,texture:q}=d[P];W===v&&SetPedComponentVariation(p,v,K,q,2)}}TaskPlayAnim(p,r,n,3,3,i,l,0,!1,!1,!1)}async function Pe(e){let{animations:a,props:t}=j[e],{dict:o,anim:r,move:n,duration:l}=a.off,{male:i,female:s}=t,c=PlayerPedId(),d=f(c);for(RequestAnimDict(o);!HasAnimDictLoaded(o);)await b(0);if(d)for(let p=0;p<i.length;p++){let[y,u]=i[p];SetPedComponentVariation(c,y,u,0,2)}else for(let p=0;p<s.length;p++){let[y,u]=s[p];SetPedComponentVariation(c,y,u,0,2)}TaskPlayAnim(c,o,r,3,3,l,n,0,!1,!1,!1)}var te=()=>Ce,R=(e,a)=>{Ce=a;let t=f(e);ClearPedDecorations(e);for(let o in a)for(let r=0;r<a[o].length;r++){let{collection:n,hashFemale:l,hashMale:i}=a[o][r],s=t?i:l;AddPedDecorationFromHashes(e,GetHashKey(n),GetHashKey(s))}},ve=(e,a)=>{let t=f(e);ClearPedDecorations(e);for(let o in a)for(let r=0;r<a[o].length;r++){let{collection:n,hashFemale:l,hashMale:i}=a[o][r],s=t?i:l;AddPedDecorationFromHashes(e,GetHashKey(n),GetHashKey(s))}},fe=(e,a)=>{let t=f(e);ClearPedDecorations(e);for(let o in a)for(let r=0;r<a[o].length;r++){let{collection:n,hashFemale:l,hashMale:i}=a[o][r],s=t?i:l;AddPedDecorationFromHashes(e,GetHashKey(n),GetHashKey(s))}},ge=(e,a,t)=>{let o=f(e),{collection:r,hashFemale:n,hashMale:l}=t,i=o?l:n;ClearPedDecorations(e),AddPedDecorationFromHashes(e,GetHashKey(r),GetHashKey(i));for(let s in a)for(let c=0;c<a[s].length;c++){let{name:d,collection:p,hashFemale:y,hashMale:u}=a[s][c];if(t.name!==d){let v=o?u:y;AddPedDecorationFromHashes(e,GetHashKey(p),GetHashKey(v))}}};function Oe(e,a=de){let t=PlayerPedId();A=H(t),U=e,ae=a,I=g(GetEntityCoords(t,!0)),Z=GetEntityHeading(t),x=!1,h=!1,ee("default"),SetNuiFocus(!0,!0),SetNuiFocusKeepInput(!1),RenderScriptCams(!0,!1,0,!0,!0),DisplayRadar(!1),SetEntityInvincible(t,!0),TaskStandStill(t,-1);let o={type:"appearance_display",payload:{}};SendNuiMessage(JSON.stringify(o))}function J(e){RenderScriptCams(!1,!1,0,!0,!0),DestroyCam(m,!1),DisplayRadar(!0),SetNuiFocus(!1,!1);let a=PlayerPedId();ClearPedTasksImmediately(a),SetEntityInvincible(a,!1);let t={type:"appearance_hide",payload:{}};if(SendNuiMessage(JSON.stringify(t)),!e)re($());else{let{tattoos:o}=e;R(a,o)}U&&U(e),U=null,ae=null,A=null,I=null,m=null,w=null,x=null,h=null}function De(e){e===GetCurrentResourceName()&&(SetNuiFocus(!1,!1),SetNuiFocusKeepInput(!1))}function Be(){_e(),on("onResourceStop",De),Ie("startPlayerCustomization",Oe)}var be={loadModule:Be};var _=global.exports,Le="0x2746bd9d88c5c5d0",Fe=JSON.parse(LoadResourceFile(GetCurrentResourceName(),"tattoos.json")),oe=JSON.parse(LoadResourceFile(GetCurrentResourceName(),"peds.json")),E=JSON.parse(LoadResourceFile(GetCurrentResourceName(),"blacklist.json")),ze=oe.reduce((e,a)=>({...e,[GetHashKey(a)]:a}),{});function Se(e){return ze[GetEntityModel(e)]}function Me(e){let a=[];return O.forEach(t=>{a.push({component_id:t,drawable:GetPedDrawableVariation(e,t),texture:GetPedTextureVariation(e,t)})}),a}function ke(e){let a=[];return D.forEach(t=>{a.push({prop_id:t,drawable:GetPedPropIndex(e,t),texture:GetPedPropTextureIndex(e,t)})}),a}function Ge(e){let a=new ArrayBuffer(80);global.Citizen.invokeNative(Le,e,new Uint32Array(a));let{0:t,2:o,6:r,8:n}=new Uint32Array(a),{0:l,2:i}=new Float32Array(a,48),s=parseFloat(l.toFixed(1)),c=parseFloat(i.toFixed(1));return{shapeFirst:t,shapeSecond:o,skinFirst:r,skinSecond:n,shapeMix:s,skinMix:c}}function Ne(e){return F.reduce((t,o,r)=>{let n=parseFloat(GetPedFaceFeature(e,r).toFixed(1));return{...t,[o]:n}},{})}function Te(e){return S.reduce((t,o,r)=>{let[,n,,l,i,s]=GetPedHeadOverlayData(e,r),c=n!==255,d=c?n:0,p=c?parseFloat(s.toFixed(1)):0,y;return o==="makeUp"?y={style:d,opacity:p,color:l,secondColor:i}:y={style:d,opacity:p,color:l},{...t,[o]:y}},{})}function Ae(e){return{style:GetPedDrawableVariation(e,2),color:GetPedHairColor(e),highlight:GetPedHairHighlightColor(e),texture:GetPedTextureVariation(e,2)}}function H(e){let a=GetPedEyeColor(e);return{model:Se(e)||"mp_m_freemode_01",headBlend:Ge(e),faceFeatures:Ne(e),headOverlays:Te(e),components:Me(e),props:ke(e),hair:Ae(e),eyeColor:a<ce.length?a:0,tattoos:te()}}async function L(e){if(!e||!IsModelInCdimage(e))return;for(RequestModel(e);!HasModelLoaded(e);)await b(0);let[a,t]=le();SetPlayerModel(PlayerId(),e),SetModelAsNoLongerNeeded(e);let o=PlayerPedId();C(o)&&(SetPedDefaultComponentVariation(o),SetPedHeadBlendData(o,0,0,0,0,0,0,0,0,0,!1)),se(a,t)}function M(e,a){if(!a)return;let{shapeFirst:t,shapeSecond:o,shapeMix:r,skinFirst:n,skinSecond:l,skinMix:i}=a;C(e)&&SetPedHeadBlendData(e,t,o,0,n,l,0,r,i,0,!1)}function k(e,a){!a||F.forEach((t,o)=>{let r=a[t];SetPedFaceFeature(e,o,r)})}function G(e,a){!a||S.forEach((t,o)=>{let r=a[t];if(SetPedHeadOverlay(e,o,r.style,r.opacity),r.color||r.color===0){let l=1;var n=r.color;({blush:!0,lipstick:!0,makeUp:!0})[t]&&(l=2),t==="makeUp"&&(n=r.secondColor),SetPedHeadOverlayColor(e,o,l,r.color,n)}})}function N(e,a){if(!a)return;let{style:t,color:o,highlight:r,texture:n}=a;SetPedComponentVariation(e,2,t,n,2),SetPedHairColor(e,o,r)}function T(e,a){!a||SetPedEyeColor(e,a)}function z(e,a){if(!a)return;let{component_id:t,drawable:o,texture:r}=a;({0:!0,2:!0})[t]&&C(e)||SetPedComponentVariation(e,t,o,r,0)}function ne(e,a){!a||a.forEach(t=>z(e,t))}function V(e,a){if(!a)return;let{prop_id:t,drawable:o,texture:r}=a;o===-1?ClearPedProp(e,t):SetPedPropIndex(e,t,o,r,!1)}function ie(e,a){!a||a.forEach(t=>V(e,t))}async function re(e){if(!e)return;let{model:a,components:t,props:o,headBlend:r,faceFeatures:n,headOverlays:l,hair:i,eyeColor:s,tattoos:c}=e;await L(a);let d=PlayerPedId();ne(d,t),ie(d,o),r&&M(d,r),n&&k(d,n),l&&G(d,l),i&&N(d,i),s&&T(d,s),c&&R(d,c)}function Ve(e,a){if(!a)return;let{components:t,props:o,headBlend:r,faceFeatures:n,headOverlays:l,hair:i,eyeColor:s,tattoos:c}=a;ne(e,t),ie(e,o),r&&M(e,r),n&&k(e,n),l&&G(e,l),i&&N(e,i),s&&T(e,s),c&&R(e,c)}function Ue(){be.loadModule(),_("getPedModel",Se),_("getPedComponents",Me),_("getPedProps",ke),_("getPedHeadBlend",Ge),_("getPedFaceFeatures",Ne),_("getPedHeadOverlays",Te),_("getPedHair",Ae),_("getPedTattoos",te),_("getPedAppearance",H),_("setPlayerModel",L),_("setPedHeadBlend",M),_("setPedFaceFeatures",k),_("setPedHeadOverlays",G),_("setPedHair",N),_("setPedEyeColor",T),_("setPedComponent",z),_("setPedComponents",ne),_("setPedProp",V),_("setPedProps",ie),_("setPedTattoos",R),_("setPlayerAppearance",re),_("setPedAppearance",Ve)}Ue();})();
